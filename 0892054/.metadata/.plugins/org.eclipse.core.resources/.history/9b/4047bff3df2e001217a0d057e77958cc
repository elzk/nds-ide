#include "FreeRTOS.h"
#include "task.h"
#include <nds.h>
#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include "sevencore_io.h"

#include "card_spi.h"
#include "gdbStub.h"
#include "gdbStubAsm.h"

static portTASK_FUNCTION(Exp_3_Task, pvParameters);
void InitDebug(void);

struct parameters{
	char *tastname;
	int direction;
	int vasePoint;
	u32 color;
	int delay;
};

struct parameters Param[NUM_TASK] = {
		{"1", DIRECTION_RIGHT, 3,  COLOR_RED, 50},
		{"2", DIRECTION_RIGHT, 6,  COLOR_RED, 10},
		{"3", DIRECTION_RIGHT, 9,  COLOR_RED, 100},
		{"4", DIRECTION_DOWN,  4,  COLOR_GREEN, 20},
		{"5", DIRECTION_DOWN,  8,  COLOR_GREEN, 70},
		{"6", DIRECTION_DOWN,  12, COLOR_GREEN, 150},
};


int
main(void)
{
	InitDebug();
	init_virtual_io(ENABLE_LED);	// Enable Virtual LED's on Top Screen
	init_printf();					// Initialize Bottom Screen for printf()

	xTaskCreate(Exp_3_Task,
					     (const signed char * const)"Exp_3_Task",
					     2048,
					     (void *)NULL,
					     tskIDLE_PRIORITY + 1,
					     NULL);

	vTaskStartScheduler();		// Never returns
	while(1)
		;
	return 0;
}

void
InitDebug(void)
{
#ifdef DEBUG
	irqInit();
	initSpi();
	initDebug();
	BreakPoint();
#endif
}
void Exp_3_Sample_A(void);
void Exp_3_Sample_B(void);
void Exp_3_Sample_C(void);
void Exp_3_Homework(void);

static
portTASK_FUNCTION(Exp_3_Task, pvParameters )
{
	while (1) {
		printf("Start Experiment 3 Start\n");
		Exp_3_Sample_A();
		Exp_3_Sample_B();
		Exp_3_Sample_C();
		Exp_3_Homework();
	}
}
